{% extends "blog/blog_base.html" %}
{% load static %}
{% load widget_tweaks %}
{% block title %}
    {% if object %}
        Edit an Article
    {% else %}
        Write an Article
    {% endif %}
{% endblock %}
{% block content %}
    <section class="login first grey">
        <div class="container">
            <div class="box-wrapper" style="width: 100%;">
                <div class="box box-border">
                    <div class="box-body">
                        <h4>
                            {% if object %}
                                Edit an Article
                            {% else %}
                                Write an Article
                            {% endif %}
                        </h4>
                        <form method="post" enctype="multipart/form-data">
                            {% csrf_token %}
                            {{ form.non_field_errors }}
                            {{ form.source.errors }}
                            {{ form.source }}

                            <div class="form-group">
                                <label>{{ form.category.label }}</label>
                                {{ form.category.tag }}
                                {{ form.category.errors }}
                                {% render_field form.category class="form-control" %}
                            </div>
                            <div class="form-group">
                                <label>{{ form.title.label }}</label>
                                {{ form.title.tag }}
                                {{ form.title.errors }}
                                {% render_field form.title class="form-control" %}
                            </div>
                            <div class="form-group">
                                <label>{{ form.description.label }}</label>
                                {{ form.description.tag }}
                                {{ form.description.errors }}
                                {% render_field form.description class="form-control" %}
                            </div>
                            <div class="form-group">
                                <label>{{ form.content.label }}</label>
                                {{ form.content.tag }}
                                {{ form.content.errors }}
                                {% render_field form.content class="form-control" rows="30" %}
                            </div>
                            <div class="form-group">
                                <label>{{ form.title_image.label }}</label>
                                {{ form.title_image.tag }}
                                {{ form.title_image.errors }}
                                {% render_field form.title_image class="form-control" %}
                            </div>                           
{#                            <div class="form-group">#}
{#                                <p><label for="id_category">Category:</label>#}
{#                                    <select name="category" required id="id_category" class="form-control"#}
{#                                            autocomplete="false">#}
{##}
{#                                        {% if object %}#}
{#                                            <option value="{{ object.id }}" selected>{{ object.title }}</option>#}
{#                                        {% else %}#}
{#                                            <option value="" selected disabled>Choose a Category</option>#}
{#                                        {% endif %}#}
{#                                        {% for c in categories %}#}
{#                                            <option value="{{ c.id }}">{{ c.title }}</option>#}
{#                                        {% endfor %}#}
{#                                    </select></p>#}
{#                            </div>#}
{#                            <div class="form-group">#}
{#                                <label for="id_title">Title:</label>#}
{#                                <input type="text" name="title" maxlength="50" required id="id_title"#}
{#                                       class="form-control" value="{{ object.title }}" autocomplete="false">#}
{#                            </div>#}
{#                            <div class="form-group">#}
{#                                <label for="id_description">Description:</label>#}
{#                                <input type="text" name="description" maxlength="225" required id="id_description"#}
{#                                       class="form-control" value="{{ object.description }}" autocomplete="false">#}
{#                            </div>#}
{#                            <div class="form-group">#}
{#                                <label for="id_content">Content:</label>#}
{#                                <textarea name="content" cols="40" rows="10" required id="id_content"#}
{#                                          class="form-control" autocomplete="false">#}
{#                                {{ object.content }}#}
{#                          </textarea>#}
{#                            </div>#}
                            <div class="form-group text-right">
                            <button type="submit" class="btn btn-primary btn-block blog-submit-button">Submit</button>
                    </div>
                    </form>
                </div>
            </div>
        </div>
        </div>
    </section>
    <!-- <script>
    document.addEventListener('DOMContentLoaded', function () {
        $('#register_form').on('submit', function (e) {
            e.preventDefault();
            let username = $('#id_username').val();
            let password1 = $('#id_password1').val();
            let password2 = $('#id_password2').val();

            $.ajax({
                url: '{% url "blog:register_check" %}',
                data: {
                    'username': username,
                    'password1': password1,
                    'password2': password2
                },
                dataType: 'json',
                success: function (error) {
                    if (error.username === 'is_taken') {
                        Swal.fire({
                            text: "A user with that username already exists",
                            icon: 'warning',
                            confirmButtonColor: '#F73F52',
                            confirmButtonText: 'OK'
                        });
                    }
                    else if (error.username == 'empty') {
                        Swal.fire({
                            text: "Username can not be empty",
                            icon: 'warning',
                            confirmButtonColor: '#F73F52',
                            confirmButtonText: 'OK'
                        });
                    }
                    else if (error.password1 == 'empty') {
                        Swal.fire({
                            text: "Password can not be empty",
                            icon: 'warning',
                            confirmButtonColor: '#F73F52',
                            confirmButtonText: 'OK'
                        });
                    }
                    else if (error.password2 == 'empty') {
                        Swal.fire({
                            text: "Password Confirmation can not be empty",
                            icon: 'warning',
                            confirmButtonColor: '#F73F52',
                            confirmButtonText: 'OK'
                        });
                    }
                    else if (error.password == '<8') {
                        Swal.fire({
                            text: "Password must contain at least 8 characters",
                            icon: 'warning',
                            confirmButtonColor: '#F73F52',
                            confirmButtonText: 'OK'
                        });
                    }
                    else if (error.password == 'only_numeric') {
                        Swal.fire({
                            text: "Password can not be entirely numeric",
                            icon: 'warning',
                            confirmButtonColor: '#F73F52',
                            confirmButtonText: 'OK'
                        });
                    }
                    else if (error.passwords == 'not_same') {
                        Swal.fire({
                            text: "Your password and password confirmation do not match",
                            icon: 'warning',
                            confirmButtonColor: '#F73F52',
                            confirmButtonText: 'OK'
                        });
                    }
                    else {
                        $("#register_form").unbind('submit').submit();
                    }
                }
            });
        });
    })
</script> -->
{% endblock %}